(()=>{customElements.define("joomla-callout",class extends HTMLElement{static get observedAttributes(){return["for","dismiss","position"]}get for(){return this.getAttribute("for")}set for(t){return this.setAttribute("for",t)}get dismiss(){return this.getAttribute("dismiss")}get position(){return this.getAttribute("position")}set position(t){return this.setAttribute("position",t)}connectedCallback(){(!this.position||this.position&&-1===["top","bottom","left","right"].indexOf(this.position))&&(this.position="right"),this.setAttribute("aria-labelledby",this.for.substring(1));const t=document.querySelector(this.for),e=this.querySelectorAll("a");t.id&&(this.hasAttribute("dismiss")&&this.appendCloseButton(),t.setAttribute("aria-haspopup",!0),t.setAttribute("aria-expanded",!1),window.addEventListener("scroll",e=>{if(e.preventDefault(),this.hasAttribute("expanded")){const e=t.getBoundingClientRect(),i=5,s=this.getBoundingClientRect(),o=this.checkPosition(this.position,e,s);this.calloutPosition(o,e,s,i)}}),t.addEventListener("click",i=>{if(i.preventDefault(),this.hasAttribute("expanded"))this.removeAttribute("expanded"),i.target.setAttribute("aria-expanded",!1);else{this.setAttribute("expanded",""),i.target.setAttribute("aria-expanded",!0);const e=t.getBoundingClientRect(),s=5,o=this.getBoundingClientRect(),n=this.checkPosition(this.position,e,o);this.calloutPosition(n,e,o,s)}document.addEventListener("click",e=>{e.target!==t&&e.target!==this&&(this.findAncestor(e.target,"joomla-callout")||this.close())}),e.forEach(t=>{t.addEventListener("click",()=>{this.close()})})}))}checkPosition(t,e,i){return"bottom"===t&&e.top+i.height>window.innerHeight?"top":"top"===t&&e.top<e.height+i.height?"bottom":"right"===t&&e.right+i.width>window.innerWidth?"left":"left"===t&&e.width+i.width>e.right?"right":t}calloutPosition(t,e,i,s){switch(t){case"top":this.style.top=`${Math.round(e.top-(i.height+s))}px`,this.style.left=`${Math.round(e.left-e.width)}px`;break;case"bottom":this.style.top=`${Math.round(e.bottom)+s}px`,this.style.left=`${Math.round(e.left-e.width)}px`;break;case"left":this.style.left=`${Math.round(e.left-(i.width+s))}px`,this.style.top=`${Math.round(e.top-i.height/2)}px`;break;default:this.style.left=`${Math.round(e.left+(e.width+s))}px`,this.style.top=`${Math.round(e.top-i.height/2)}px`}}dispatchCustomEvent(t){const e=new CustomEvent(t);e.relatedTarget=this,this.dispatchEvent(e),this.removeEventListener(t,this)}close(){const t=document.querySelector(`#${this.getAttribute("aria-labelledby")}`);this.removeAttribute("expanded"),t.setAttribute("aria-expanded",!1)}appendCloseButton(){const t=this,e=document.createElement("button");this.hasAttribute("dismiss")&&(e.classList.add("joomla-callout--close"),e.innerHTML='<span aria-hidden="true">&times;</span>',e.setAttribute("aria-label",this.getText("JCLOSE","Close"))),this.firstChild?this.insertBefore(e,this.firstChild):this.appendChild(e),e&&e.addEventListener("click",e=>{e.preventDefault(),t.dispatchCustomEvent("joomla.alert.buttonClicked"),t.close()})}findAncestor(t,e){for(;(t=t.parentElement)&&t.nodeName.toLowerCase()!==e;);return t}getText(t,e){return window.Joomla&&Joomla.JText&&Joomla.JText._&&"function"==typeof Joomla.JText._&&Joomla.JText._(t)?Joomla.JText._(t):e}})})();